<div class="col-12 col-md-6 col-lg-4 p-2">
  <div class="card h-100 shadow-sm rounded-4 overflow-hidden border-0 property-card">
    <!-- Property Image Section -->
    <div class="position-relative property-image-section">
      <img class="property-image"
           src="{{ MEDIA_URL }}{{ property.photo_main }}"
           alt="{{ property.name }}" />

      <!-- Image Count Badge -->
      <div class="position-absolute top-0 end-0 m-3">
        <span class="badge bg-dark bg-opacity-75 px-3 py-2 rounded-3 property-image-count">
          <i class="fas fa-camera me-1"></i> {{ property.portions.count }}
        </span>
      </div>

      <!-- Agent/Owner Info -->
      {% if property.user %}
      <div class="position-absolute bottom-0 start-0 end-0 m-3 agent-info-overlay">
        <div class="bg-white rounded-3 p-3 shadow-sm d-flex align-items-center gap-2">
          {% if property.user.profile.photo %}
          <img src="{{ MEDIA_URL }}{{ property.user.profile.photo }}"
               class="rounded-circle agent-photo"
               alt="{{ property.user.get_full_name }}" />
          {% else %}
          <div class="rounded-circle bg-primary d-flex align-items-center justify-content-center text-white fw-bold agent-initials">
            {{ property.user.first_name|slice:":1" }}{{ property.user.last_name|slice:":1" }}
          </div>
          {% endif %}
          <div class="flex-grow-1">
            <div class="fw-semibold d-flex align-items-center gap-1 agent-name">
              {{ property.user.get_full_name }}
              <i class="fas fa-check-circle text-primary agent-verified-icon"></i>
            </div>
            {% if property.user.profile.phone %}
            <div class="text-muted d-flex align-items-center gap-1 agent-phone">
              <i class="fas fa-phone agent-phone-icon"></i>
              {{ property.user.profile.phone }}
            </div>
            {% endif %}
          </div>
        </div>
      </div>
      {% endif %}
    </div>

    <!-- Property Details -->
    <div class="card-body">
      <!-- Action Buttons -->
      <div class="d-flex gap-2 mb-3">
        <a href="{% url 'clients:portions_a_building' property_id=property.id %}"
           class="btn btn-sm btn-outline-secondary rounded-2 d-flex align-items-center justify-content-center property-action-btn">
          <i class="fas fa-map-marker-alt"></i>
        </a>
        <button class="btn btn-sm btn-outline-secondary rounded-2 d-flex align-items-center justify-content-center property-action-btn"
                onclick="this.classList.toggle('text-danger'); this.classList.toggle('border-danger');">
          <i class="far fa-heart"></i>
        </button>
      </div>

      <!-- Property Title -->
      <h5 class="fw-bold mb-2 property-title">{{ property.title }}</h5>

      <!-- Property Specs -->
      <div class="d-flex gap-3 mb-2 text-muted property-specs">
        <span>
          <i class="fas fa-building me-1"></i> {{ property.portion_count }} Units
        </span>
        <span>
          <i class="fas fa-door-open me-1"></i> {{ property.portions.count }}
        </span>
      </div>

      <!-- Property Address -->
      <div class="text-muted mb-2 property-address">
        <i class="fas fa-location-dot me-1"></i>
        Zone {{ property.zone_no }}, St. {{ property.street_no }}, Building {{ property.property_no }}
      </div>

      <div class="text-muted mb-3 property-landmark">
        {{ property.landmark }}
      </div>

      <!-- Property Code Info -->
      <div class="d-flex flex-wrap gap-2 mb-3">
        <span class="badge bg-primary-subtle text-primary px-2 py-1">{{ property.client_code }}</span>
        <span class="badge bg-secondary-subtle text-secondary px-2 py-1">{{ property.property_code }}</span>
      </div>

      <!-- Listed By -->
      <div class="text-muted small">
        Listed by YellowKey Real Estate
      </div>
    </div>

    <!-- View Details Button -->
    <div class="card-footer bg-white border-0 pt-0">
      <a href="{% url 'clients:portions_a_building' property_id=property.id %}"
         class="btn btn-primary w-100 rounded-2">
        <i class="fas fa-eye me-2"></i>View All Portions
      </a>
    </div>
  </div>
</div>